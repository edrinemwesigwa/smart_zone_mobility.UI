{"ast":null,"code":"import { throwError } from \"rxjs\";\nimport { catchError, finalize } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./loading.service\";\nexport class HttpErrorInterceptor {\n  constructor(loadingService) {\n    this.loadingService = loadingService;\n  }\n  intercept(request, next) {\n    // Don't show loading for certain requests\n    const hideLoading = request.headers.has(\"X-Hide-Loading\");\n    if (!hideLoading) {\n      this.loadingService.show();\n    }\n    return next.handle(request).pipe(catchError(error => {\n      let errorMessage = \"An unexpected error occurred\";\n      if (error.error instanceof ErrorEvent) {\n        // Client-side error\n        errorMessage = `Error: ${error.error.message}`;\n      } else {\n        // Server-side error\n        switch (error.status) {\n          case 0:\n            errorMessage = \"Unable to connect to server. Please check your internet connection.\";\n            break;\n          case 400:\n            errorMessage = error.error?.message || \"Bad request. Please check your input.\";\n            break;\n          case 401:\n            errorMessage = \"Unauthorized. Please log in again.\";\n            break;\n          case 403:\n            errorMessage = \"Access denied. You do not have permission.\";\n            break;\n          case 404:\n            errorMessage = \"Resource not found.\";\n            break;\n          case 500:\n            errorMessage = \"Server error. Please try again later.\";\n            break;\n          default:\n            errorMessage = `Error ${error.status}: ${error.message}`;\n        }\n      }\n      console.error(\"HTTP Error:\", error);\n      return throwError(() => new Error(errorMessage));\n    }), finalize(() => {\n      if (!hideLoading) {\n        this.loadingService.hide();\n      }\n    }));\n  }\n  static {\n    this.ɵfac = function HttpErrorInterceptor_Factory(t) {\n      return new (t || HttpErrorInterceptor)(i0.ɵɵinject(i1.LoadingService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: HttpErrorInterceptor,\n      factory: HttpErrorInterceptor.ɵfac,\n      providedIn: \"root\"\n    });\n  }\n}","map":{"version":3,"names":["throwError","catchError","finalize","HttpErrorInterceptor","constructor","loadingService","intercept","request","next","hideLoading","headers","has","show","handle","pipe","error","errorMessage","ErrorEvent","message","status","console","Error","hide","i0","ɵɵinject","i1","LoadingService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\edrin\\OneDrive\\Desktop\\Mobility\\SmartMobilitySimulator.UI\\src\\app\\services\\http-error.interceptor.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\r\nimport {\r\n  HttpInterceptor,\r\n  HttpRequest,\r\n  HttpHandler,\r\n  HttpEvent,\r\n  HttpErrorResponse,\r\n} from \"@angular/common/http\";\r\nimport { Observable, throwError, BehaviorSubject } from \"rxjs\";\r\nimport { catchError, finalize } from \"rxjs/operators\";\r\nimport { LoadingService } from \"./loading.service\";\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class HttpErrorInterceptor implements HttpInterceptor {\r\n  constructor(private loadingService: LoadingService) {}\r\n\r\n  intercept(\r\n    request: HttpRequest<any>,\r\n    next: HttpHandler,\r\n  ): Observable<HttpEvent<any>> {\r\n    // Don't show loading for certain requests\r\n    const hideLoading = request.headers.has(\"X-Hide-Loading\");\r\n    if (!hideLoading) {\r\n      this.loadingService.show();\r\n    }\r\n\r\n    return next.handle(request).pipe(\r\n      catchError((error: HttpErrorResponse) => {\r\n        let errorMessage = \"An unexpected error occurred\";\r\n\r\n        if (error.error instanceof ErrorEvent) {\r\n          // Client-side error\r\n          errorMessage = `Error: ${error.error.message}`;\r\n        } else {\r\n          // Server-side error\r\n          switch (error.status) {\r\n            case 0:\r\n              errorMessage =\r\n                \"Unable to connect to server. Please check your internet connection.\";\r\n              break;\r\n            case 400:\r\n              errorMessage =\r\n                error.error?.message || \"Bad request. Please check your input.\";\r\n              break;\r\n            case 401:\r\n              errorMessage = \"Unauthorized. Please log in again.\";\r\n              break;\r\n            case 403:\r\n              errorMessage = \"Access denied. You do not have permission.\";\r\n              break;\r\n            case 404:\r\n              errorMessage = \"Resource not found.\";\r\n              break;\r\n            case 500:\r\n              errorMessage = \"Server error. Please try again later.\";\r\n              break;\r\n            default:\r\n              errorMessage = `Error ${error.status}: ${error.message}`;\r\n          }\r\n        }\r\n\r\n        console.error(\"HTTP Error:\", error);\r\n        return throwError(() => new Error(errorMessage));\r\n      }),\r\n      finalize(() => {\r\n        if (!hideLoading) {\r\n          this.loadingService.hide();\r\n        }\r\n      }),\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"mappings":"AAQA,SAAqBA,UAAU,QAAyB,MAAM;AAC9D,SAASC,UAAU,EAAEC,QAAQ,QAAQ,gBAAgB;;;AAMrD,OAAM,MAAOC,oBAAoB;EAC/BC,YAAoBC,cAA8B;IAA9B,KAAAA,cAAc,GAAdA,cAAc;EAAmB;EAErDC,SAASA,CACPC,OAAyB,EACzBC,IAAiB;IAEjB;IACA,MAAMC,WAAW,GAAGF,OAAO,CAACG,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;IACzD,IAAI,CAACF,WAAW,EAAE;MAChB,IAAI,CAACJ,cAAc,CAACO,IAAI,EAAE;;IAG5B,OAAOJ,IAAI,CAACK,MAAM,CAACN,OAAO,CAAC,CAACO,IAAI,CAC9Bb,UAAU,CAAEc,KAAwB,IAAI;MACtC,IAAIC,YAAY,GAAG,8BAA8B;MAEjD,IAAID,KAAK,CAACA,KAAK,YAAYE,UAAU,EAAE;QACrC;QACAD,YAAY,GAAG,UAAUD,KAAK,CAACA,KAAK,CAACG,OAAO,EAAE;OAC/C,MAAM;QACL;QACA,QAAQH,KAAK,CAACI,MAAM;UAClB,KAAK,CAAC;YACJH,YAAY,GACV,qEAAqE;YACvE;UACF,KAAK,GAAG;YACNA,YAAY,GACVD,KAAK,CAACA,KAAK,EAAEG,OAAO,IAAI,uCAAuC;YACjE;UACF,KAAK,GAAG;YACNF,YAAY,GAAG,oCAAoC;YACnD;UACF,KAAK,GAAG;YACNA,YAAY,GAAG,4CAA4C;YAC3D;UACF,KAAK,GAAG;YACNA,YAAY,GAAG,qBAAqB;YACpC;UACF,KAAK,GAAG;YACNA,YAAY,GAAG,uCAAuC;YACtD;UACF;YACEA,YAAY,GAAG,SAASD,KAAK,CAACI,MAAM,KAAKJ,KAAK,CAACG,OAAO,EAAE;;;MAI9DE,OAAO,CAACL,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;MACnC,OAAOf,UAAU,CAAC,MAAM,IAAIqB,KAAK,CAACL,YAAY,CAAC,CAAC;IAClD,CAAC,CAAC,EACFd,QAAQ,CAAC,MAAK;MACZ,IAAI,CAACO,WAAW,EAAE;QAChB,IAAI,CAACJ,cAAc,CAACiB,IAAI,EAAE;;IAE9B,CAAC,CAAC,CACH;EACH;;;uBAzDWnB,oBAAoB,EAAAoB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,cAAA;IAAA;EAAA;;;aAApBvB,oBAAoB;MAAAwB,OAAA,EAApBxB,oBAAoB,CAAAyB,IAAA;MAAAC,UAAA,EAFnB;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}