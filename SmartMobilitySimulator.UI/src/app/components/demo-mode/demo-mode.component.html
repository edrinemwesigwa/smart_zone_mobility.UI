<section class="demo-section">
  <div class="demo-header">
    <h2>Quick Demo</h2>
    <p>Launch government-ready scenarios with one click.</p>
  </div>

  <div class="demo-panel">
    <div class="demo-left">
      <h3>One-Click Demo Launcher</h3>
      <div class="demo-buttons">
        <button (click)="launchDemo('mussafah')" class="primary">
          Mussafah Gridlock
        </button>
        <button (click)="launchDemo('marina')" class="primary">
          Marina Chaos
        </button>
        <button (click)="launchDemo('school')" class="primary">
          School Safety
        </button>
      </div>

      <div class="demo-for">
        <h3>Demo for Agency</h3>
        <label>Agency</label>
        <select [(ngModel)]="selectedAgency">
          <option *ngFor="let agency of agencyOptions" [value]="agency">
            {{ agency }}
          </option>
        </select>

        <div *ngIf="selectedAgency === 'Custom'">
          <label>Custom Agency Name</label>
          <input type="text" [(ngModel)]="customAgency" />
        </div>

        <label>Agency Logo</label>
        <input type="file" accept="image/*" (change)="onLogoUpload($event)" />
        <div *ngIf="logoDataUrl" class="logo-preview">
          <img [src]="logoDataUrl" alt="Agency logo" />
        </div>
      </div>

      <div class="demo-actions">
        <button
          class="secondary"
          (click)="downloadPackage()"
          [disabled]="!simulation"
        >
          Download Demo Package (ZIP)
        </button>
        <button
          class="secondary"
          (click)="startPresentation()"
          [disabled]="!scenario"
        >
          Start Presentation
        </button>
      </div>

      <div class="status" *ngIf="isLoading">Launching demo...</div>
      <div class="error" *ngIf="error">{{ error }}</div>
    </div>

    <div class="demo-right">
      <h3>Demo Script</h3>
      <p class="agency-line">Prepared for {{ agencyName }}</p>
      <div class="step-card" *ngIf="demoSteps.length">
        <h4>{{ demoSteps[activeStepIndex].title }}</h4>
        <p>{{ demoSteps[activeStepIndex].text }}</p>
        <div class="notes" *ngIf="showNotes">
          <strong>Speaker Notes</strong>
          <p>{{ demoSteps[activeStepIndex].notes }}</p>
        </div>
        <div class="step-controls">
          <button (click)="prevStep()">Back</button>
          <button (click)="nextStep()">Next</button>
          <button (click)="toggleNotes()">
            {{ showNotes ? "Hide" : "Show" }} Notes
          </button>
        </div>
      </div>
      <div class="step-card" *ngIf="!demoSteps.length">
        <p>Select a demo scenario to load the script.</p>
      </div>
    </div>
  </div>

  <div class="presentation-overlay" *ngIf="isPresenting">
    <div class="presentation">
      <div class="presentation-header">
        <div>
          <h3>{{ agencyName }}</h3>
          <p>{{ scenario?.name }}</p>
        </div>
        <img *ngIf="logoDataUrl" [src]="logoDataUrl" alt="Agency logo" />
      </div>

      <div class="presentation-body">
        <h1>{{ demoSteps[activeStepIndex].title }}</h1>
        <p>{{ demoSteps[activeStepIndex].text }}</p>
        <div
          class="results"
          *ngIf="demoSteps[activeStepIndex].title === 'Results' && simulation"
        >
          <div>
            <span>Congestion Reduction</span>
            <strong
              >{{ simulation.congestionReduction | number: "1.1-1" }}%</strong
            >
          </div>
          <div>
            <span>Estimated Revenue</span>
            <strong>AED {{ simulation.estimatedRevenue | number }}</strong>
          </div>
          <div>
            <span>Vehicles Diverted</span>
            <strong>{{ simulation.vehiclesDiverted | number }}</strong>
          </div>
        </div>
      </div>

      <div class="presentation-footer">
        <button (click)="prevStep()">Back</button>
        <button (click)="nextStep()">Next</button>
        <button class="danger" (click)="stopPresentation()">Exit</button>
      </div>

      <div class="speaker-notes" *ngIf="showNotes">
        <h4>Speaker Notes</h4>
        <p>{{ demoSteps[activeStepIndex].notes }}</p>
      </div>
    </div>
  </div>
</section>



